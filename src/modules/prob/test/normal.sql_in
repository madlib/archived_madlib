--------------------------------------------------------------------------------
-- Test normal distribution probability functions with both normal and spurious input
-------------------------------------------------------------------------------- 
-- select MADLIB_SCHEMA.normal_pdf(-1, -1, -1);

select (MADLIB_SCHEMA.normal_pdf('NaN', -1, 2) = 'NaN')::int - 1 as shouldBeZero;
select (MADLIB_SCHEMA.normal_pdf(-1, 'NaN', 2) = 'NaN')::int - 1 as shouldBeZero;
select (MADLIB_SCHEMA.normal_pdf(-1, -1, 'NaN') = 'NaN')::int - 1 as shouldBeZero;

select count(MADLIB_SCHEMA.normal_pdf(-1, -1, NULL)) as shouldBeZero;
select count(MADLIB_SCHEMA.normal_pdf(NULL, -1, 2)) as shouldBeZero;
select count(MADLIB_SCHEMA.normal_pdf(-1, NULL, 2)) as shouldBeZero;

select (abs(MADLIB_SCHEMA.normal_pdf(-0.99, -1, 2)::REAL - (1/((2)*sqrt(2*pi())))*exp(-1*power(-0.99 + 1, 2)/(2*power(2,2)))::REAL) < (1e-7))::int - 1 as shouldbezero;
select (abs(MADLIB_SCHEMA.normal_pdf(-1, -1, 1)::REAL - (1/((1)*sqrt(2*pi())))*exp(-1*power(-1 + 1, 2)/(2*power(1,2)))::REAL) < (1e-7))::int - 1 as shouldBeZero;
select (abs(MADLIB_SCHEMA.normal_pdf(0.99, 1, 2)::REAL - (1/((2)*sqrt(2*pi())))*exp(-1*power(0.99 - 1, 2)/(2*power(2,2)))::REAL) < (1e-7))::int - 1 as shouldbezero;

