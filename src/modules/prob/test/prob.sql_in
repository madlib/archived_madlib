--------------------------------------------------------------------------------
-- Test distribution functions with both normal and spurious input
--------------------------------------------------------------------------------

set search_path=MADLIB_SCHEMA


--
-- Student's T-distribution
--
select students_t_cdf(NULL, 0)::REAL;
select students_t_cdf(0, NULL)::REAL;
select students_t_cdf(NULL, NULL)::REAL;
select students_t_cdf(NULL, 12)::REAL;
-- select students_t_cdf(1,  0)::REAL; 
-- select students_t_cdf(1, '-0')::REAL; 
-- select students_t_cdf(1, -2)::REAL;
-- select students_t_cdf(1, '-Infinity')::REAL;
-- select students_t_cdf(1, 'Infinity')::REAL;
-- select students_t_cdf(1, 'NaN')::REAL;
select students_t_cdf(-2000, 1)::REAL;
select students_t_cdf(2, 2)::REAL;
select students_t_cdf(-2, 2)::REAL;
select students_t_cdf(0, 1)::REAL;
select students_t_cdf('-0', 1000)::REAL;
select students_t_cdf(0.25, 10)::REAL;
select students_t_cdf(0.25, 300)::REAL;
select students_t_cdf(1, 1600)::REAL;
select students_t_cdf(1.79e308, 2147483647)::REAL;
select students_t_cdf('Infinity', 1)::REAL;
select students_t_cdf('-Infinity', 1)::REAL;
select students_t_cdf('NaN', 1)::REAL;

select students_t_cdf(2000, 1)::REAL - (1./2 + 1/pi() * atan(2000))::REAL AS shouldBeZero;
select students_t_cdf(-3, 2)::REAL - (1./2 * (1. + (-3.)/sqrt(2. + pow(-3, 2))))::REAL AS shouldBeZero;


select students_t_pdf(NULL, 0)::REAL;
select students_t_pdf(0, NULL)::REAL;
select students_t_pdf(NULL, NULL)::REAL;
select students_t_pdf(NULL, 12)::REAL;
-- select students_t_pdf(1,  0)::REAL; 
-- select students_t_pdf(1, '-0')::REAL; 
-- select students_t_pdf(1, -2)::REAL;
-- select students_t_pdf(1, '-Infinity')::REAL;
-- select students_t_pdf(1, 'Infinity')::REAL;
-- select students_t_pdf(1, 'NaN')::REAL;
select students_t_pdf(-2000, 1)::REAL;
select students_t_pdf(2, 2)::REAL;
select students_t_pdf(-2, 2)::REAL;
select students_t_pdf(0, 1)::REAL;
select students_t_pdf('-0', 1000)::REAL;
select students_t_pdf(0.25, 10)::REAL;
select students_t_pdf(0.25, 300)::REAL;
select students_t_pdf(1, 1600)::REAL;
select students_t_pdf(1.79e308, 2147483647)::REAL;
select students_t_pdf('Infinity', 1)::REAL;
select students_t_pdf('-Infinity', 1)::REAL;
select students_t_pdf('NaN', 1)::REAL;


select students_t_quantile(0, 1);
select students_t_quantile(.1, 1);
select students_t_quantile(.2, 1);
select students_t_quantile(.3, 1);
select students_t_quantile(.4, 1);
select students_t_quantile(.5, 1);
select students_t_quantile(.6, 1);
select students_t_quantile(.7, 1);
select students_t_quantile(.8, 1);
select students_t_quantile(.9, 1);
select students_t_quantile( 1, 1);

select students_t_quantile(.1, NULL);
-- select students_t_quantile(.1, 'Infinity');
-- select students_t_quantile(.1, 'NaN');
-- select students_t_quantile(.1, 1e208);

select students_t_quantile(.2, .1);
select students_t_quantile(.6, .1);
select students_t_quantile(.2, 100);
select students_t_quantile(.6, 100);


--
-- Chi^2 distribution
--

select chi_squared_cdf(NULL, 0)::REAL;
select chi_squared_cdf(0, NULL)::REAL;
select chi_squared_cdf(NULL, NULL)::REAL;
select chi_squared_cdf(NULL, 12)::REAL;
-- select chi_squared_cdf(1,  0)::REAL; 
-- select chi_squared_cdf(1, '-0')::REAL; 
-- select chi_squared_cdf(1, -2)::REAL;
-- select chi_squared_cdf(1, '-Infinity')::REAL;
-- select chi_squared_cdf(1, 'Infinity')::REAL;
-- select chi_squared_cdf(1, 'NaN')::REAL;
-- select chi_squared_cdf(-2000, 1)::REAL;
select chi_squared_cdf(2, 2)::REAL;
-- select chi_squared_cdf(-2, 2)::REAL;
select chi_squared_cdf(0, 1)::REAL;
select chi_squared_cdf('-0', 1000)::REAL;
select chi_squared_cdf(0.25, 10)::REAL;
select chi_squared_cdf(0.25, 300)::REAL;
select chi_squared_cdf(1, 1600)::REAL;
select chi_squared_cdf(1.79e308, 2147483647)::REAL;
-- select chi_squared_cdf('Infinity', 1)::REAL;
-- select chi_squared_cdf('-Infinity', 1)::REAL;
-- select chi_squared_cdf('NaN', 1)::REAL;

select chi_squared_pdf(NULL, 0)::REAL;
select chi_squared_pdf(0, NULL)::REAL;
select chi_squared_pdf(NULL, NULL)::REAL;
select chi_squared_pdf(NULL, 12)::REAL;
-- select chi_squared_pdf(1,  0)::REAL; 
-- select chi_squared_pdf(1, '-0')::REAL; 
-- select chi_squared_pdf(1, -2)::REAL;
-- select chi_squared_pdf(1, '-Infinity')::REAL;
-- select chi_squared_pdf(1, 'Infinity')::REAL;
-- select chi_squared_pdf(1, 'NaN')::REAL;
-- select chi_squared_pdf(-2000, 1)::REAL;
select chi_squared_pdf(2, 2)::REAL;
-- select chi_squared_pdf(-2, 2)::REAL;
select chi_squared_pdf(0, 1)::REAL;
select chi_squared_pdf('-0', 1000)::REAL;
select chi_squared_pdf(0.25, 10)::REAL;
select chi_squared_pdf(0.25, 300)::REAL;
select chi_squared_pdf(1, 1600)::REAL;
select chi_squared_pdf(1.79e308, 2147483647)::REAL;
-- select chi_squared_pdf('Infinity', 1)::REAL;
-- select chi_squared_pdf('-Infinity', 1)::REAL;
-- select chi_squared_pdf('NaN', 1)::REAL;


select chi_squared_quantile(0, 1);
select chi_squared_quantile(.1, 1);
select chi_squared_quantile(.2, 1);
select chi_squared_quantile(.3, 1);
select chi_squared_quantile(.4, 1);
select chi_squared_quantile(.5, 1);
select chi_squared_quantile(.6, 1);
select chi_squared_quantile(.7, 1);
select chi_squared_quantile(.8, 1);
select chi_squared_quantile(.9, 1);
select chi_squared_quantile( 1, 1);

select chi_squared_quantile(.1, NULL);
-- select chi_squared_quantile(.1, 'Infinity');
-- select chi_squared_quantile(.1, 'NaN');
select chi_squared_quantile(.1, 1e208);

select chi_squared_quantile(.2, .1);
select chi_squared_quantile(.6, .1);
select chi_squared_quantile(.2, 100);
select chi_squared_quantile(.6, 100);


--
-- Gamma distribution
--

select gamma_cdf(NULL, 0, 0)::REAL;
select gamma_cdf(0, NULL, 0)::REAL;
select gamma_cdf(0, 0, NULL)::REAL;
select gamma_cdf(NULL, NULL, NULL)::REAL;
-- select gamma_cdf(1,  0)::REAL; 
-- select gamma_cdf(1, '-0')::REAL; 
-- select gamma_cdf(1, -2)::REAL;
-- select gamma_cdf(1, '-Infinity')::REAL;
-- select gamma_cdf(1, 'Infinity')::REAL;
-- select gamma_cdf(1, 'NaN')::REAL;
-- select gamma_cdf(-2000, 1)::REAL;   -- R has r <= 0 -> 0 rather than error
-- select gamma_cdf(1, -1, 1)::REAL;
-- select gamma_cdf(1, 0, 1)::REAL;    -- R allos shape = 0
-- select gamma_cdf(1, 1, 0)::REAL;
select gamma_cdf(2, 2, 2)::REAL;
-- select gamma_cdf(-2, 2, 2)::REAL;
select gamma_cdf(0, 1, 1)::REAL;
select gamma_cdf('-0', 1000, 1)::REAL;
select gamma_cdf(0.25, 10, 1)::REAL;
select gamma_cdf(0.25, 1, 300)::REAL;
select gamma_cdf(1, 1600, 1)::REAL;
select gamma_cdf(1.79e308, 2147483647, 1)::REAL;
-- select gamma_cdf('Infinity', 1, 1)::REAL;
-- select gamma_cdf('-Infinity', 1, 1)::REAL;
-- select gamma_cdf('NaN', 1, 1)::REAL;


select gamma_pdf(NULL, 0, 0)::REAL;
select gamma_pdf(0, NULL, 0)::REAL;
select gamma_pdf(0, 0, NULL)::REAL;
select gamma_pdf(NULL, NULL, NULL)::REAL;
-- select gamma_pdf(1,  0)::REAL; 
-- select gamma_pdf(1, '-0')::REAL; 
-- select gamma_pdf(1, -2)::REAL;
-- select gamma_pdf(1, '-Infinity')::REAL;
-- select gamma_pdf(1, 'Infinity')::REAL;
-- select gamma_pdf(1, 'NaN')::REAL;
-- select gamma_pdf(-2000, 1)::REAL;   -- R has r <= 0 -> 0 rather than error
-- select gamma_pdf(1, -1, 1)::REAL;
-- select gamma_pdf(1, 0, 1)::REAL;    -- R allows shape = 0
-- select gamma_pdf(1, 1, 0)::REAL;
select gamma_pdf(2, 2, 2)::REAL;
-- select gamma_pdf(-2, 2, 2)::REAL;
select gamma_pdf(0, 1, 1)::REAL;
select gamma_pdf('-0', 1000, 1)::REAL;
select gamma_pdf(0.25, 10, 1)::REAL;
select gamma_pdf(0.25, 1, 300)::REAL;
select gamma_pdf(1, 1600, 1)::REAL;
select gamma_pdf(1.79e308, 2147483647, 1)::REAL;
-- select gamma_pdf('Infinity', 1, 1)::REAL;
-- select gamma_pdf('-Infinity', 1, 1)::REAL;
-- select gamma_pdf('NaN', 1, 1)::REAL;

select gamma_quantile(0, 1, 1);
select gamma_quantile(.1, 1, 1);
select gamma_quantile(.2, 1, 1);
select gamma_quantile(.3, 1, 1);
select gamma_quantile(.4, 1, 1);
select gamma_quantile(.5, 1, 1);
select gamma_quantile(.6, 1, 1);
select gamma_quantile(.7, 1, 1);
select gamma_quantile(.8, 1, 1);
select gamma_quantile(.9, 1, 1);
select gamma_quantile( 1, 1, 1);

select gamma_quantile(.1, NULL);
-- select gamma_quantile(.1, 'Infinity');
-- select gamma_quantile(.1, 'NaN');
select gamma_quantile(.1, 1e208);

select gamma_quantile(.2, .1, 1);
select gamma_quantile(.6, .1, 1);
select gamma_quantile(.2, 100, 1);
select gamma_quantile(.6, 100, 1);
select gamma_quantile(.2, 1, .1);
select gamma_quantile(.6, 1, .1);
select gamma_quantile(.2, 1, 100);
select gamma_quantile(.6, 1, 100);


reset search_path;